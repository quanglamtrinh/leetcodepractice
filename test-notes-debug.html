<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Notes Debug Test</title>
    <style>
        body { font-family: Arial, sans-serif; padding: 20px; }
        .test-container { border: 1px solid #ccc; padding: 20px; margin: 10px 0; }
        .notes-tab { min-height: 400px; border: 1px solid #ddd; padding: 10px; }
        .status { margin: 10px 0; padding: 10px; background: #f0f0f0; }
    </style>
</head>
<body>
    <h1>Notes Tab Debug Test</h1>
    
    <div class="status" id="status">Loading...</div>
    
    <div class="test-container">
        <h2>Enhanced Notes Tab Test</h2>
        <div id="notes-tab" class="notes-tab">
            <!-- Enhanced notes will be mounted here -->
        </div>
    </div>
    
    <div class="test-container">
        <h2>Debug Controls</h2>
        <button onclick="testMount()">Test Mount Enhanced Notes</button>
        <button onclick="testUpdate()">Test Update Problem</button>
        <button onclick="checkIntegration()">Check Integration Status</button>
    </div>

    <!-- React and ReactDOM -->
    <script crossorigin src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    
    <!-- Enhanced Notes Integration -->
    <script src="enhanced-notes-standalone.js"></script>
    <script src="enhanced-notes-react-integration.js"></script>
    
    <script>
        const status = document.getElementById('status');
        
        function updateStatus(message) {
            status.textContent = message;
            console.log(message);
        }
        
        function checkIntegration() {
            updateStatus('Checking integration...');
            console.log('React:', typeof React !== 'undefined' ? 'Available' : 'Missing');
            console.log('ReactDOM:', typeof ReactDOM !== 'undefined' ? 'Available' : 'Missing');
            console.log('mountEnhancedNotesTab:', typeof window.mountEnhancedNotesTab !== 'undefined' ? 'Available' : 'Missing');
            console.log('updateEnhancedNotesTabProblem:', typeof window.updateEnhancedNotesTabProblem !== 'undefined' ? 'Available' : 'Missing');
            
            if (typeof window.mountEnhancedNotesTab === 'function') {
                updateStatus('✅ Enhanced notes integration is available');
            } else {
                updateStatus('❌ Enhanced notes integration is NOT available');
            }
        }
        
        function testMount() {
            updateStatus('Testing mount...');
            
            const testProblem = {
                id: 1,
                title: 'Test Problem',
                notes: JSON.stringify([
                    { id: 1, type: 'heading', content: 'Test Notes' },
                    { id: 2, type: 'text', content: 'This is a test of the enhanced notes editor.' },
                    { id: 3, type: 'bullet', content: 'Feature 1: Slash commands' },
                    { id: 4, type: 'todo', content: 'Test todo item', checked: false }
                ])
            };
            
            if (window.mountEnhancedNotesTab) {
                try {
                    window.mountEnhancedNotesTab(testProblem, 'notes-tab');
                    updateStatus('✅ Enhanced notes mounted successfully');
                } catch (error) {
                    updateStatus('❌ Error mounting: ' + error.message);
                    console.error(error);
                }
            } else {
                updateStatus('❌ mountEnhancedNotesTab function not available');
            }
        }
        
        function testUpdate() {
            updateStatus('Testing update...');
            
            const testProblem2 = {
                id: 2,
                title: 'Updated Test Problem',
                notes: JSON.stringify([
                    { id: 1, type: 'heading', content: 'Updated Notes' },
                    { id: 2, type: 'text', content: 'This is updated content.' }
                ])
            };
            
            if (window.updateEnhancedNotesTabProblem) {
                try {
                    window.updateEnhancedNotesTabProblem(testProblem2);
                    updateStatus('✅ Enhanced notes updated successfully');
                } catch (error) {
                    updateStatus('❌ Error updating: ' + error.message);
                    console.error(error);
                }
            } else {
                updateStatus('❌ updateEnhancedNotesTabProblem function not available');
            }
        }
        
        // Auto-check integration on load
        setTimeout(() => {
            checkIntegration();
        }, 1000);
    </script>
</body>
</html>