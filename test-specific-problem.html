<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Test Specific Problem Notes</title>
    <link rel="stylesheet" href="styles.css">
    <style>
        body { font-family: Arial, sans-serif; padding: 20px; }
        .test-container { border: 1px solid #ccc; padding: 20px; margin: 10px 0; }
        .status { margin: 10px 0; padding: 10px; background: #f0f0f0; }
        .notes-panel { max-width: 800px; }
        .notes-header { display: flex; justify-content: space-between; align-items: center; margin-bottom: 10px; }
        .problem-info { background: #f8f9fa; padding: 15px; margin: 10px 0; border-radius: 5px; }
    </style>
</head>
<body>
    <h1>Test Specific Problem Notes</h1>
    
    <div class="status" id="status">Ready to test...</div>
    
    <div class="test-container">
        <h2>Test Controls</h2>
        <button onclick="testProblem16()">Test Problem 16 (Has Enhanced Notes)</button>
        <button onclick="testProblem27()">Test Problem 27 (Has Many Notes)</button>
        <button onclick="testProblem245()">Test Problem 245 (Has Lots of Notes)</button>
        <button onclick="debugCurrent()">Debug Current Problem</button>
        <button onclick="reloadNotes()">Reload Notes</button>
    </div>
    
    <div id="problemInfo" class="problem-info" style="display: none;">
        <h3>Current Problem Info</h3>
        <div id="problemDetails"></div>
    </div>
    
    <div class="test-container">
        <div class="notes-panel">
            <!-- Notes Tab -->
            <div class="notes-header">
                <span>üìù Notes</span>
                <span id="notesStatus" class="notes-status"></span>
            </div>
            <div
                id="notesEditor"
                class="notes-editor"
                contenteditable="true"
                spellcheck="false"
                placeholder="Write your notes here‚Ä¶"
            ></div>
        </div>
    </div>

    <!-- Load the fix -->
    <script src="fix-notes-tab.js"></script>
    
    <script>
        const status = document.getElementById('status');
        const problemInfo = document.getElementById('problemInfo');
        const problemDetails = document.getElementById('problemDetails');
        
        function updateStatus(message) {
            status.textContent = message;
            console.log(message);
        }
        
        function showProblemInfo(problem) {
            problemInfo.style.display = 'block';
            problemDetails.innerHTML = `
                <strong>ID:</strong> ${problem.id}<br>
                <strong>Title:</strong> ${problem.title}<br>
                <strong>Notes Length:</strong> ${problem.notes?.length || 0} characters<br>
                <strong>Has Notes:</strong> ${problem.notes ? 'Yes' : 'No'}
            `;
        }
        
        async function testProblem16() {
            updateStatus('Testing Problem 16...');
            const problem = {
                id: 16,
                title: 'Create Maximum Number',
                notes: '' // Will be loaded from DB
            };
            
            window.currentProblem = problem;
            showProblemInfo(problem);
            
            try {
                await window.loadNoteForProblem(problem);
                updateStatus('‚úÖ Problem 16 loaded');
            } catch (error) {
                updateStatus('‚ùå Error loading Problem 16: ' + error.message);
            }
        }
        
        async function testProblem27() {
            updateStatus('Testing Problem 27...');
            const problem = {
                id: 27,
                title: 'Longest Repeating Character Replacement',
                notes: ''
            };
            
            window.currentProblem = problem;
            showProblemInfo(problem);
            
            try {
                await window.loadNoteForProblem(problem);
                updateStatus('‚úÖ Problem 27 loaded');
            } catch (error) {
                updateStatus('‚ùå Error loading Problem 27: ' + error.message);
            }
        }
        
        async function testProblem245() {
            updateStatus('Testing Problem 245...');
            const problem = {
                id: 245,
                title: 'Count Number of Nice Subarrays',
                notes: ''
            };
            
            window.currentProblem = problem;
            showProblemInfo(problem);
            
            try {
                await window.loadNoteForProblem(problem);
                updateStatus('‚úÖ Problem 245 loaded');
            } catch (error) {
                updateStatus('‚ùå Error loading Problem 245: ' + error.message);
            }
        }
        
        function debugCurrent() {
            if (window.debugCurrentNotes) {
                window.debugCurrentNotes();
            } else {
                console.log('Debug function not available');
            }
        }
        
        function reloadNotes() {
            if (window.reloadCurrentNotes) {
                window.reloadCurrentNotes();
            } else {
                console.log('Reload function not available');
            }
        }
        
        // Auto-test Problem 16 on load
        setTimeout(() => {
            testProblem16();
        }, 1000);
    </script>
</body>
</html>